### **Feature Layer (Functional Breakdown)**
*Translating business needs from the BRD into tangible functional capabilities for the "ArchitectPulse" system.*

---

### **Deliverable: Feature List**
*A categorized list of the system's core capabilities.*

**1. Core Platform Features**
*   **User Authentication & Authorization:**
    *   **User Registration:** A secure way for new users to be onboarded (likely by an Admin).
    *   **Login/Logout:** Secure session management for users to access the system.
    *   **Role-Based Access Control (RBAC):** A system to define and assign roles (e.g., Admin, Head Lawyer, Subordinate Lawyer, Sales Manager) with distinct permissions, ensuring users only see and do what they are authorized for.
*   **Centralized Dashboard:**
    *   A personalized landing page that displays relevant information based on the user's role (e.g., an Admin sees firm-wide stats, a Head Lawyer sees their cases, a Sales Manager sees their pipeline).
*   **Global Search:**
    *   A search bar to quickly find contacts, cases, or documents across the system.

**2. Legal Case Management Module (for InnerWorks)**
*   **Client Management:**
    *   Ability to add, view, edit, and archive client profiles (e.g., Client 1, Client 2).
*   **Case Creation & Management:**
    *   Functionality for an Admin to create a new case, assign a type (Civil, Criminal, Corporate Legal), and link it to a client.
*   **Hierarchical Assignment Engine:**
    *   **Admin-to-HL Assignment:** Admins can assign one or more Head Lawyers (HL) to a specific case.
    *   **HL-to-SL/OL Assignment:** Head Lawyers can assign specific Subordinate Lawyers (both internal SLs and external OLs) to the cases they manage.
*   **Case Workspace:**
    *   A dedicated view for each case, containing all related information: case details, assigned personnel, documents, tasks, and a history log.
*   **Digital Document Management:**
    *   **Secure File Upload:** Ability for authorized lawyers to upload documents (PDF, DOCX, images) to a specific case file.
    *   **Version Control (Basic):** Tracks different versions of uploaded documents.
    *   **Centralized Document Repository:** All documents for a case are accessible in one place for all assigned lawyers.

**3. General CRM Module (for NeuEarth)**
*   **Contact Management:**
    *   A central database to store and manage contacts (e.g., Jane Doe, Lisa Wong), including names, emails, and notes.
*   **Visual Sales Pipeline:**
    *   A Kanban-style board where deals can be moved through customizable stages (e.g., Lead, Contacted, Proposal, Closed).
    *   Each stage displays the total monetary value of the deals within it.
*   **Task Management:**
    *   A to-do list feature allowing users to create, assign, set due dates for, and check off tasks related to contacts or deals (e.g., "Follow up with Jane Doe").

**4. Communication & Notifications Module**
*   **Internal Notification System:** In-app alerts for actions like new case assignments or task updates.
*   **External Client Notifications (WhatsApp Integration):** An automated system to send predefined status updates to non-technical end-clients via WhatsApp when key case milestones are achieved.

**5. Analytics & Reporting Module**
*   **Performance Dashboard:** A visual dashboard with charts and graphs (as seen in the mockup) to display key metrics like sales trends, cases closed per month, or deal conversion rates.

---

### **Deliverable: Feature-to-Component Mapping**
*Mapping each feature to its potential frontend and backend components.*

| Feature | Frontend Component(s) | Backend Component(s) / Service(s) |
| :--- | :--- | :--- |
| **User Authentication** | `LoginPage.vue`/`jsx` <br> `AuthForm` component <br> Session management (cookies/tokens) in browser | `AuthService` <br> `UserController` <br> REST API endpoints (`/login`, `/logout`) <br> Password hashing logic <br> `User` database model |
| **Role-Based Access** | Conditional rendering logic (e.g., `v-if="user.role === 'Admin'"`). <br> Navigation guards to protect routes. | `AuthorizationMiddleware` (to protect API routes). <br> `Role` and `Permission` database models. <br> Logic in services to check permissions before executing actions. |
| **Case Creation** | `CreateCaseModal.vue`/`jsx` <br> A multi-step form for client selection, case details, and HL assignment. | `CaseController` (`/api/cases/create`). <br> `CaseService` (to handle validation and business logic). <br> `Case` and `Client` database models. |
| **Hierarchical Assignment**| `CaseAssignmentPanel` component inside the case workspace. <br> Dropdowns/multi-select lists to choose lawyers. | `AssignmentController` (`/api/cases/{id}/assign`). <br> `AssignmentService` to manage the complex relationships between Cases, HLs, and SLs/OLs. <br> Join tables in the database (e.g., `case_lawyer_assignments`). |
| **Document Upload** | `FileUpload` component with drag-and-drop UI. <br> Progress bar display. <br> `DocumentList` component to display uploaded files. | `DocumentController` (`/api/cases/{id}/upload`). <br> `FileStorageService` (interfaces with AWS S3, Azure Blob, or local storage). <br> `Document` database model (storing metadata and file path). |
| **Visual Sales Pipeline** | `PipelineBoard.vue`/`jsx` component. <br> Draggable `DealCard` components. <br> Columns representing pipeline stages. | `DealController` (`/api/deals/updateStage`). <br> `PipelineService` to handle business logic for moving deals and calculating stage values. <br> `Deal` database model with a `stage` field. |
| **WhatsApp Notification**| A settings page (`NotificationSettings.vue`) to configure message templates. | A dedicated `NotificationService`. <br> Integration with a third-party API provider (e.g., Twilio API for WhatsApp). <br> A `QueueWorker` to send notifications asynchronously without blocking the main app. |

---

### **Deliverable: Feature Flow Diagrams**
*Step-by-step descriptions visualizing how users interact with key features.*

#### **Flow 1: Legal Case Creation and Assignment**
*   **Goal:** To create a new case for a client and assign the correct legal team.
*   **Actors:** Admin (ADM), Head Lawyer (HL), Subordinate Lawyer (SL).

1.  **Admin Action:** Logs into the ArchitectPulse system.
2.  **System Response:** Displays the Admin Dashboard.
3.  **Admin Action:** Clicks "Create New Case".
4.  **System Response:** Presents a form to select an existing client or create a new one, then enter case details (e.g., "CASE 25 - Corporate Legal").
5.  **Admin Action:** Fills out the form and selects one or more Head Lawyers (e.g., HL3) from a list to manage the case. Clicks "Save Case".
6.  **System Response:**
    *   Creates the new case in the database.
    *   Associates it with the client and the assigned Head Lawyer (HL3).
    *   Sends an in-app notification to HL3: "You have been assigned to a new case: CASE 25".
7.  **Head Lawyer (HL3) Action:** Logs in and sees the notification. Clicks on "CASE 25" in their case list.
8.  **System Response:** Displays the Case Workspace for CASE 25.
9.  **Head Lawyer Action:** Clicks "Manage Team" or "Assign Lawyers".
10. **System Response:** Shows a panel with lists of available internal (SLs) and external (OLs) lawyers.
11. **Head Lawyer Action:** Selects `SL2`, `SL10`, and `OL7` for this case and clicks "Confirm Assignments".
12. **System Response:**
    *   Updates the case record with the new assignments.
    *   Sends in-app notifications to `SL2`, `SL10`, and `OL7`.
13. **Subordinate Lawyer (SL2) Action:** Logs in and sees "CASE 25" on their personal dashboard, ready to be worked on.

#### **Flow 2: Document Upload and Access**
*   **Goal:** To solve the "hard copy" problem by digitizing and sharing case documents securely.
*   **Actors:** Subordinate Lawyer (SL), Head Lawyer (HL).

1.  **SL Action:** Logs in and navigates to the workspace for "CASE 25".
2.  **System Response:** Displays the case details.
3.  **SL Action:** Clicks on the "Documents" tab and then "Upload Document".
4.  **System Response:** Opens a file browser or shows a drag-and-drop area.
5.  **SL Action:** Selects a PDF file ("Initial_Client_Agreement.pdf") from their computer and clicks "Upload".
6.  **System Response:**
    *   Shows a progress bar.
    *   Upon completion, the file is sent to the backend. The `FileStorageService` saves it to a secure location (e.g., S3 bucket), and the `DocumentController` saves the file's metadata (name, path, uploader, timestamp) to the database, linked to "CASE 25".
    *   The "Documents" tab now lists "Initial_Client_Agreement.pdf".
7.  **Head Lawyer (HL) Action:** Later, the HL logs in and navigates to "CASE 25".
8.  **System Response:** Displays the case workspace.
9.  **HL Action:** Clicks the "Documents" tab.
10. **System Response:** Shows the list of all documents for this case, including "Initial_Client_Agreement.pdf".
11. **HL Action:** Clicks the download icon next to the file name.
12. **System Response:** The system retrieves the file from its storage location and initiates a download to the HL's computer.

#### **Flow 3: Progressing a Lead in the Sales Pipeline**
*   **Goal:** To manage a sales lead from initial contact to a closed deal.
*   **Actor:** Sales Manager.

1.  **Sales Manager Action:** Logs into the system.
2.  **System Response:** Displays the Sales Dashboard with the visual Sales Pipeline. A new lead, "Acme Inc - $5,000," appears in the "Lead" column.
3.  **Sales Manager Action:** Drags the "Acme Inc" card from the "Lead" column to the "Contacted" column after making an initial call.
4.  **System Response:**
    *   The UI updates instantly.
    *   An API call is made to the backend to update the deal's stage in the database.
    *   The total value displayed at the top of the "Lead" column decreases by $5,000, and the "Contacted" column increases by $5,000.
5.  **Sales Manager Action:** Clicks on the "Acme Inc" card to open its details. Clicks "Add Task".
6.  **System Response:** A form appears to create a new task.
7.  **Sales Manager Action:** Enters "Send proposal to Acme Inc," sets a due date, and saves the task.
8.  **System Response:** The task is added to the Sales Manager's main task list and is also visible within the "Acme Inc" deal details.
9.  **Sales Manager Action:** After sending the proposal, they drag the "Acme Inc" card from "Contacted" to "Proposal".
10. **System Response:** The system again updates the stage in the database and recalculates the column totals.
