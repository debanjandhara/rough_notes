### **System Layer (Architecture & Components)**
*Translating features into a robust, scalable, and maintainable system architecture.*

---

### **Deliverable: System Context Diagram**
*This diagram shows the boundary of the "ArchitectPulse" system and how it interacts with external users and systems. It provides a high-level, "zoomed-out" view.*

```
+-----------------------------------------------------------------------------------+
|                                                                                   |
|      +---------------------+      +---------------------+      +----------------+ |
|      |    Legal User       |      |    Sales User       |      |   End-Client   | |
|      | (Admin, HL, SL)     |      |  (Sales Manager)    |      | (of InnerWorks)| |
|      +---------------------+      +---------------------+      +----------------+ |
|                 |                          |                           ^          |
|                 | Uses Web App via HTTPS   |                           |          |
|                 v                          v                           |          |
|      +------------------------------------------------------------------+          |
|      |                                                                  |          |
|      |                      ARCHITECTPULSE SYSTEM                       |          |
|      |  +------------------------------------------------------------+  |          |
|      |  |                                                            |  |          |
|      |  |                    Frontend Web App (SPA)                  |  |          |
|      |  |                                                            |  |          |
|      |  +------------------------------------------------------------+  |          |
|      |                          ^           |                           |          |
|      |   Serves Assets          |           | Makes API Calls (REST/GraphQL) |          |
|      |                          |           v                           |          |
|      |  +------------------------------------------------------------+  |          |
|      |  |                                                            |  |          |
|      |  |                       Backend Services                     |------------->| Sends Notifications
|      |  |                     (Hosted on Cloud)                      |<------------ | via API
|      |  +------------------------------------------------------------+  |          |
|      |                          |           ^                           |          |
|      |   Reads/Writes Data      |           | Stores/Retrieves Files    |          |
|      |                          v           |                           |          |
|      |  +-----------------------+  +-------------------------+          |          |
|      |  |     Database          |  |   Object Storage        |          |          |
|      |  |  (e.g., PostgreSQL)   |  |     (e.g., AWS S3)      |          |          |
|      |  +-----------------------+  +-------------------------+          |          |
|      |                                                                  |          |
|      +------------------------------------------------------------------+          |
|                                                                                   |
+-----------------------------------------------------------------------------------+
                                                                                     ^
                                                                                     | API Calls
                                                                                     v
                                      +------------------------------------------------+
                                      |             External Third-Party APIs          |
                                      |------------------------------------------------|
                                      |  - Twilio API (for WhatsApp Notifications)     |
                                      |  - Auth0 / AWS Cognito (for Authentication)    |
                                      |  - Email Service (e.g., SendGrid)              |
                                      +------------------------------------------------+
```

---

### **Deliverable: Component Breakdown**
*This diagram breaks the "ArchitectPulse System" into its internal services/modules. We'll use a microservices-oriented approach for modularity and scalability, aligning with the BRD's vision.*

#### **1. Presentation Layer (Frontend)**
*   **Single Page Application (SPA):** A modern, responsive web application built with a framework like **Vue.js**, **React**, or **Angular**. This single codebase will use Role-Based Access Control (RBAC) to render the correct UI components and layouts for different user personas (Legal vs. Sales).

#### **2. Application Layer (Backend Services)**
*This is the core logic of the system, broken into distinct services that communicate via an API Gateway.*

*   **API Gateway:** A single entry point for all frontend requests. It handles routing, authentication checks, rate limiting, and directs traffic to the appropriate downstream service.
    *   **Technology:** Amazon API Gateway, Kong, or a custom Nginx setup.

*   **Authentication Service:**
    *   **Responsibilities:** Manages user identity, registration, login, token generation (JWTs), and password management. It is the source of truth for user roles.
    *   **Interacts with:** External auth provider (like AWS Cognito), User Database.

*   **Legal Case Management Service:**
    *   **Responsibilities:** All business logic related to the InnerWorks use case. Manages clients, cases, and the complex hierarchical assignments between Admins, HLs, and SLs/OLs.
    *   **Interacts with:** Database, Notification Service (for assignments).

*   **CRM Service:**
    *   **Responsibilities:** All business logic for the general CRM use case (NeuEarth). Manages contacts, deals, and the visual sales pipeline.
    *   **Interacts with:** Database, Task Management logic.

*   **Document Management Service:**
    *   **Responsibilities:** Handles secure file uploads, metadata storage, and generates secure, temporary URLs for downloads. It does **not** store the files itself.
    *   **Interacts with:** Database (for metadata), Object Storage (for files).

*   **Notification Service:**
    *   **Responsibilities:** Manages sending all communications. It is designed to be asynchronous to avoid blocking user requests. It takes requests (e.g., "send case update to client X") and processes them in the background.
    *   **Interacts with:** External APIs (Twilio for WhatsApp, SendGrid for email), Message Queue.

#### **3. Data & Infrastructure Layer**

*   **Primary Database:** A relational database to store structured data like users, cases, clients, deals, tasks, and document metadata.
    *   **Technology:** **PostgreSQL** (managed via AWS RDS) is an excellent choice for its robustness and support for complex queries.

*   **Object Storage:** A highly durable, scalable storage solution for unstructured data, specifically the documents uploaded by lawyers.
    *   **Technology:** **Amazon S3** or Azure Blob Storage.

*   **Message Queue:** A messaging broker used to decouple services, especially for asynchronous tasks like sending notifications. When a case is updated, the Case Service publishes a message like `case_updated` to the queue, and the Notification Service subscribes to these messages to act on them.
    *   **Technology:** **RabbitMQ** or AWS SQS.

---

### **Deliverable: Infrastructure Choices**
*Specific technology and platform decisions to support the architecture above. We'll base this on a cloud-native AWS stack for scalability, reliability, and reduced operational overhead.*

*   **Cloud Provider:** **Amazon Web Services (AWS)**
    *   **Reasoning:** Mature platform with a comprehensive suite of managed services that perfectly match our component needs, allowing the development team to focus on business logic rather than infrastructure management.

*   **Compute (Backend Services):**
    *   **Choice:** **AWS Fargate** with **Docker Containers**.
    *   **Reasoning:** Fargate is a serverless compute engine for containers. This means we can package each microservice (Auth, Case Management, etc.) into its own Docker container and run it without having to manage the underlying servers. It scales automatically and is cost-effective.

*   **Frontend Hosting:**
    *   **Choice:** **AWS S3** for static hosting + **AWS CloudFront** (CDN).
    *   **Reasoning:** This is a standard, highly performant, and low-cost pattern for hosting SPAs. S3 hosts the compiled HTML/CSS/JS files, and CloudFront distributes them globally, ensuring fast load times for all users.

*   **Database:**
    *   **Choice:** **AWS RDS for PostgreSQL**.
    *   **Reasoning:** A managed database service that handles backups, patching, security, and scaling automatically, significantly reducing the operational burden on the team.

*   **Authentication Provider:**
    *   **Choice:** **AWS Cognito** or **Auth0**.
    *   **Reasoning:** Outsourcing authentication to a specialized service is more secure and faster to implement than building it from scratch. Cognito integrates well within the AWS ecosystem, while Auth0 offers excellent developer experience and flexibility.

*   **CI/CD (DevOps Pipeline):**
    *   **Choice:** **GitHub Actions** for CI/CD, **Git** for source control.
    *   **Workflow:**
        1.  **Code Commit:** Developer pushes code to a feature branch in a GitHub repository.
        2.  **Pull Request:** A pull request triggers an automated workflow in GitHub Actions.
        3.  **Build & Test:** The workflow builds the Docker container(s) and runs automated tests (unit, integration).
        4.  **Publish:** On a successful merge to the `main` branch, the workflow pushes the new Docker image to a registry (**Amazon ECR** - Elastic Container Registry).
        5.  **Deploy:** The workflow then triggers a deployment service (**AWS CodePipeline** or scripts) to update the Fargate service with the new container image, resulting in a zero-downtime deployment.
